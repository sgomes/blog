<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Using Sass to automatically pick text colors</title>
  <meta name="description" content="I’m Sérgio, and I work at Web Developer Relations at Google, helping developers make the web a better place.">

    <!--
      Hello, and welcome to the source for my site!
      There's not a lot to see around here, but I hope you get some inspiration/ideas/laughs.

      Here's an ASCII art stick figure saying hi:  o/
                                                  /|
                                                  / \
    -->

  <link rel="canonical" href="https://sgom.es/">
  <link rel="alternate" type="application/rss+xml" title="sgom.es" href="/feed.xml">

  <link rel="manifest" href="/manifest.json">

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="sgom.es">
  <link rel="icon" sizes="16x16" href="/assets/images/touch/16x16.png">
  <link rel="icon" sizes="32x32" href="/assets/images/touch/32x32.png">
  <link rel="icon" sizes="192x192" href="/assets/images/touch/192x192.png">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="sgom.es">
  <link rel="apple-touch-icon" href="/assets/images/touch/152x152.png">

  <meta name="msapplication-TileImage" content="/assets/images/touch/144x144.png">
  <meta name="msapplication-TileColor" content="#009688">

  <meta name="theme-color" content="#009688">

  <style>
  @font-face{font-display:fallback;font-family:'Roboto';font-style:normal;font-weight:400;src:local("Roboto"),local("Roboto-Regular"),url(/assets/fonts/oMMgfZMQthOryQo9n22dcuvvDin1pK8aKteLpeZ5c0A.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215}@font-face{font-display:fallback;font-family:'Roboto';font-style:normal;font-weight:500;src:local("Roboto Medium"),local("Roboto-Medium"),url(/assets/fonts/RxZJdnzeo3R5zSexge8UUZBw1xU1rKptJj_0jans920.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215}@font-face{font-display:fallback;font-family:'Roboto';font-style:normal;font-weight:700;src:local("Roboto Bold"),local("Roboto-Bold"),url(/assets/fonts/d-6IYplOFocCacKzxwXSOJBw1xU1rKptJj_0jans920.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215}@font-face{font-display:fallback;font-family:'Roboto';font-style:italic;font-weight:400;src:local("Roboto Italic"),local("Roboto-Italic"),url(/assets/fonts/vPcynSL0qHq_6dX7lKVByXYhjbSpvc47ee6xR_80Hnw.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215}@font-face{font-display:fallback;font-family:'Roboto';font-style:italic;font-weight:500;src:local("Roboto Medium Italic"),local("Roboto-MediumItalic"),url(/assets/fonts/OLffGBTaF0XFOW1gnuHF0Ygp9Q8gbYrhqGlRav_IXfk.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;src:local("Roboto Mono"),local("RobotoMono-Regular"),url(/assets/fonts/hMqPNLsu_dywMa4C_DEpY4gp9Q8gbYrhqGlRav_IXfk.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2212,U+2215}.mdc-button{font-family:Roboto,sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-size:.875rem;letter-spacing:.04em;line-height:1.5rem;color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-light,rgba(0,0,0,.87));display:inline-block;position:relative;min-width:64px;height:36px;padding:0 16px;border:none;border-radius:2px;outline:none;background:0 0;font-size:14px;font-weight:500;line-height:36px;text-align:center;text-transform:uppercase;vertical-align:middle;box-sizing:border-box;-webkit-appearance:none;-webkit-tap-highlight-color:transparent}.mdc-button--theme-dark,.mdc-theme--dark .mdc-button{color:#fff;color:var(--mdc-theme-text-primary-on-dark,#fff)}.mdc-button::before{position:absolute;top:0;left:0;width:100%;height:100%;transition:opacity 120ms 0ms cubic-bezier(.4,0,1,1);border-radius:inherit;background:currentColor;content:"";opacity:0}.mdc-button:focus::before{transition:opacity 120ms 0ms cubic-bezier(0,0,.2,1);opacity:.12}.mdc-button:active::before{transition:opacity 120ms 0ms cubic-bezier(0,0,.2,1);opacity:.18}.mdc-button:focus:active::before{transition-timing-function:cubic-bezier(.4,0,.2,1)}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button--dense{height:32px;font-size:.8125rem;line-height:32px}.mdc-button--raised{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);transition:box-shadow 280ms cubic-bezier(.4,0,.2,1);will-change:box-shadow;min-width:88px}.mdc-button--raised:active{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.mdc-button--theme-dark .mdc-button--raised,.mdc-theme--dark .mdc-button--raised{background-color:#009688;background-color:var(--mdc-theme-primary,#009688)}.mdc-button--accent.mdc-button--raised::before,.mdc-button--primary.mdc-button--raised::before,.mdc-button--theme-dark .mdc-button--raised::before,.mdc-theme--dark .mdc-button--raised::before{color:#000}.mdc-button--primary,.mdc-button--theme-dark .mdc-button--primary,.mdc-theme--dark .mdc-button--primary{color:#009688;color:var(--mdc-theme-primary,#009688)}.mdc-button--primary.mdc-button--raised{background-color:#009688;background-color:var(--mdc-theme-primary,#009688);color:#fff;color:var(--mdc-theme-text-primary-on-primary,#fff)}.mdc-button--accent,.mdc-button--theme-dark .mdc-button--accent,.mdc-theme--dark .mdc-button--accent{color:#ffab40;color:var(--mdc-theme-accent,#ffab40)}.mdc-button--accent.mdc-button--raised{background-color:#ffab40;background-color:var(--mdc-theme-accent,#ffab40);color:rgba(0,0,0,.87);color:var(--mdc-theme-text-primary-on-accent,rgba(0,0,0,.87))}.mdc-button--compact{padding:0 8px}.mdc-button:disabled,fieldset:disabled .mdc-button{color:rgba(0,0,0,.26);cursor:default;pointer-events:none}.mdc-button--theme-dark .mdc-button:disabled,.mdc-button--theme-dark fieldset:disabled .mdc-button,.mdc-theme--dark .mdc-button:disabled,.mdc-theme--dark fieldset:disabled .mdc-button{color:rgba(255,255,255,.3)}.mdc-button--raised:disabled,fieldset:disabled .mdc-button--raised{box-shadow:0 0 0 0 rgba(0,0,0,.2),0 0 0 0 rgba(0,0,0,.14),0 0 0 0 rgba(0,0,0,.12);background-color:rgba(0,0,0,.12);pointer-events:none}.mdc-button--theme-dark .mdc-button--raised:disabled,.mdc-button--theme-dark fieldset:disabled .mdc-button--raised,.mdc-theme--dark .mdc-button--raised:disabled,.mdc-theme--dark fieldset:disabled .mdc-button--raised{background-color:rgba(255,255,255,.12)}.header{display:flex;height:80px;background:#009688;color:#fff;justify-content:center;align-items:center;flex-shrink:0;z-index:2;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.header-title{text-decoration:none;color:#fff;font-family:Roboto,sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-size:2.125rem;letter-spacing:normal;line-height:2.5rem;margin:-.5rem 0 4rem -.07em;font-weight:700}.header-title:hover,.header-title:visited{color:#fff}.post{background:#fff;padding:48px 24px;margin:0 auto;color:rgba(0,0,0,.87);width:100%;max-width:45rem;box-sizing:border-box}.post-meta,.post-title{display:block;color:#009688;font-family:Roboto,sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}.post-title{margin:-.5rem 0 1rem -.06em;font-size:1.5rem;letter-spacing:normal;line-height:2rem;font-weight:700;margin-bottom:0}.post-meta{font-size:.875rem;font-weight:500;letter-spacing:.04em;line-height:1.5rem;margin-bottom:16px}.post-tags{display:inline-block;flex-grow:1;font-family:'Roboto Mono',monospace;letter-spacing:normal}.post-image{display:block;max-width:100%;margin:0 auto}.post-content,.post-content h1{font-family:Roboto,sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}.post-content{line-height:1.25rem;font-size:1rem}.post-content,.post-content h1,.post-content pre{font-weight:400;letter-spacing:normal}.post-content h1{font-size:1.5rem;line-height:2rem}.post-content h2,.post-content h3{letter-spacing:.02em;line-height:2rem}.post-content figcaption,.post-content h2,.post-content h3,.post-content h4,.post-content strong{font-family:Roboto,sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-weight:500}.post-content h2{margin-top:2rem;font-size:1.25rem}.post-content figcaption,.post-content h3,.post-content h4,.post-content strong{font-size:1rem}.post-content h3{color:rgba(0,0,0,.7)}.post-content figcaption,.post-content h4,.post-content strong{line-height:1.5rem;letter-spacing:normal}.post-content a,.post-content a:hover,.post-content a:visited{color:#00bfa5}.post-content code,.post-content pre{font-size:.9375rem;font-family:'Roboto Mono',monospace}.post-content pre{border-radius:2px;margin:0;padding:16px;font-style:normal;line-height:normal;overflow-x:auto;background:#f5f5f5}.post-content code{color:#0d47a1}.post-content figure{max-width:100%;box-sizing:border-box}.post-content figcaption{text-align:center;font-size:.75rem;font-weight:400;letter-spacing:.08em;line-height:1.25rem}.post-content blockquote{margin:2em 2.5em 3em}.post-content table{margin:2rem 0;border-collapse:collapse;text-align:center}.post-content table td,.post-content table th{padding:8px;border:1px solid #ddd}.post-content .overflow-x{overflow-x:auto}.home,.home-post-list{padding:24px 0;box-sizing:border-box}.home-post-list{list-style:none;padding:0 8px;margin:0 auto;width:100%;max-width:45rem}.home-post-entry,.home-post-title{font-family:Roboto,sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}.home-post-entry{background:#fff;padding:16px;box-sizing:border-box;width:100%;border-radius:2px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);font-size:.875rem;font-weight:400;letter-spacing:.04em;line-height:1.25rem}.home-post-entry+.home-post-entry,.post-content pre+pre{margin-top:16px}.home-post-title{display:inline;padding-right:4px;font-size:1.5rem;letter-spacing:normal;line-height:2rem;margin:-.5rem 0 1rem -.06em;font-weight:700}.footer-copyright a,.home-post-title>a{text-decoration:none;color:#009688}.home-post-title>a:hover,.home-post-title>a:visited{color:#009688}.home-post-meta{display:inline-block;margin-bottom:0}.home-post-excerpt{margin:8px 0 0;color:rgba(0,0,0,.87);font-family:Roboto,sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-weight:400;line-height:1.25rem;font-size:1rem;letter-spacing:normal}.home-post-bottom{display:flex;flex-flow:row;padding-top:16px}.home-pagination{display:flex;flex-flow:row nowrap;padding:16px 8px;box-sizing:border-box;margin:0 auto;width:100%;max-width:45rem}.home-page-previous{margin-right:auto}.home-page-next{margin-left:auto}.footer,.footer-contents{display:flex;flex-shrink:0;box-sizing:border-box;width:100%}.footer{background-color:#009688;color:#fff;z-index:2;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);flex-flow:column nowrap;padding:16px}.footer-contents{position:relative;flex-flow:row nowrap;justify-content:center;align-items:center;margin:0 auto;padding:0 24px;max-width:45rem}@media (max-width:600px){.footer-contents{flex-wrap:wrap;padding:0}}.footer-avatar{border-radius:10%;width:100px;height:100px;background:#000;flex-grow:0;flex-shrink:0;margin-right:16px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.footer-text{flex-grow:1;flex-shrink:1;padding:16px;width:50%}.footer-heading{font-family:Roboto,sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-size:1.25rem;font-weight:500;letter-spacing:.02em;line-height:2rem;margin:-.5rem 0 1rem -.05em;margin-bottom:8px}.footer-description{margin:0}.footer-icons,.footer-icons-row{display:block;flex-shrink:0}@media (max-width:600px){.footer-icons-row{display:inline-block}}.footer-bubble{display:inline-block;border-radius:50%;height:40px;width:40px;flex-shrink:0;margin:2px;background-repeat:no-repeat;background-size:contain;background-position:center}.footer-twitter{background-image:url(/assets/images/twitter.svg)}.footer-github{border-radius:0;background-image:url(/assets/images/github.svg)}.footer-email{background-image:url(/assets/images/email.svg)}.footer-feed{background-image:url(/assets/images/feed.svg)}.footer-bottom{display:flex;position:relative;justify-content:center;margin:8px auto 0;flex-shrink:0;width:100%;max-width:45rem}.footer-bottom::before{display:block;position:absolute;top:50%;width:100%;height:1px;background:rgba(255,255,255,.17);content:''}.footer-copyright,body,html{font-family:Roboto,sans-serif;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}.footer-copyright{display:inline-block;text-align:center;background:#009688;z-index:2;font-size:.75rem;font-weight:400;letter-spacing:.08em;line-height:1.25rem;padding:0 8px}.footer-copyright a{color:#fff;font-weight:700}.footer-copyright a:hover,.footer-copyright a:visited{color:#fff}.post-content pre code{color:rgba(0,0,0,.87)}.post-content pre code .comment,.post-content pre code .comment .markup.link{color:#616161}.post-content pre code .entity.name.type{color:#3e2723}.post-content pre code .entity.other.inherited-class{color:#1b5e20}.post-content pre code .keyword,.post-content pre code .keyword.control,.post-content pre code .storage{color:#4a148c}.post-content pre code .keyword.operator{color:rgba(0,0,0,.87)}.post-content pre code .keyword.other.special-method{color:#0d47a1}.post-content pre code .constant,.post-content pre code .constant.numeric,.post-content pre code .keyword.other.unit{color:#e65100}.post-content pre code .constant.character.escape,.post-content pre code .constant.other.color{color:#006064}.post-content pre code .constant.other.symbol{color:#1b5e20}.post-content pre code .variable{color:#b71c1c}.post-content pre code .string.regexp .source.ruby.embedded,.post-content pre code .variable.interpolation{color:#3e2723}.post-content pre code .variable.parameter.function{color:rgba(0,0,0,.87)}.post-content pre code .invalid.illegal{background-color:#b71c1c;color:#f5f5f5}.post-content pre code .string{color:#1b5e20}.post-content pre code .string.regexp{color:#006064}.post-content pre code .string.other.link{color:#b71c1c}.post-content pre code .punctuation.definition.array,.post-content pre code .punctuation.definition.parameters{color:rgba(0,0,0,.87)}.post-content pre code .punctuation.definition.heading,.post-content pre code .punctuation.definition.identity{color:#0d47a1}.post-content pre code .punctuation.definition.bold{color:#3e2723;font-weight:700}.post-content pre code .punctuation.definition.italic{color:#4a148c;font-style:italic}.post-content pre code .punctuation.section.embedded,.post-content pre code .support.class{color:#3e2723}.post-content pre code .punctuation.section.class,.post-content pre code .punctuation.section.inner-class,.post-content pre code .punctuation.section.method{color:rgba(0,0,0,.87)}.post-content pre code .support.function{color:#006064}.post-content pre code .entity.name.function,.post-content pre code .support.function.any-method{color:#0d47a1}.post-content pre code .entity.name.class,.post-content pre code .entity.name.type.class,.post-content pre code .meta.class{color:#3e2723}.post-content pre code .entity.name.section,.post-content pre code .entity.other.attribute-name.id{color:#0d47a1}.post-content pre code .entity.name.tag{color:#b71c1c}.post-content pre code .entity.other.attribute-name,.post-content pre code .meta.link{color:#e65100}.post-content pre code .meta.class.body,.post-content pre code .meta.method,.post-content pre code .meta.method-call{color:rgba(0,0,0,.87)}.post-content pre code .markup.heading .punctuation.definition.heading,.post-content pre code .meta.require{color:#0d47a1}.post-content pre code .meta.selector{color:#4a148c}.post-content pre code .meta.separator{background-color:#373b41;color:rgba(0,0,0,.87)}.post-content pre code .meta.tag,.post-content pre code .none{color:rgba(0,0,0,.87)}.post-content pre code .markup.bold{color:#e65100;font-weight:700}.post-content pre code .markup.changed{color:#4a148c}.post-content pre code .markup.deleted{color:#b71c1c}.post-content pre code .markup.italic{color:#4a148c;font-style:italic}.post-content pre code .markup.heading{color:#b71c1c}.post-content pre code .markup.link{color:#0d47a1}.post-content pre code .markup.inserted{color:#1b5e20}.post-content pre code .markup.quote{color:#e65100}.post-content pre code .markup.raw{color:#1b5e20}.post-content pre code .source.gfm .markup{-webkit-font-smoothing:auto}.post-content pre code .source.gfm .link .entity{color:#006064}body,html{display:flex;flex-direction:column;margin:0;padding:0;box-sizing:border-box;height:100%}.site-content{flex-grow:1;background:#eceff1}.mdc-button{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;text-decoration:none}
  </style>

  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90468985-1', 'auto');
  ga('send', 'pageview');

</script>

  
</head>


  <body>

    <header class="header" role="banner">
<div>
  <a class="header-title" href="/">sgom.es</a>
  <!-- No, I'm not Spanish. I just like short domain names. -->
</div>
</header>


    <main class="site-content" aria-label="Content">
        
<article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Using Sass to automatically pick text colors</h1>
    <time class="post-meta" datetime="2016-12-21T16:51:00+00:00" itemprop="datePublished">(2016-12-21)</time>
  </header>

  <div class="post-content" itemprop="articleBody">
    
<p><em>Originally <a href="https://medium.com/dev-channel/using-sass-to-automatically-pick-text-colors-4ba7645d2796">posted on Medium</a></em></p>
<p>Theming is always a challenge, particularly when you’re working on a library, rather than a standalone website. One example of an interesting issue that you’ll come across very frequently is choosing a text color that ensures readability and accessibility.</p>
<p><img class="post-image" src="light-dark.png" alt="Dark text on light background and vice-versa" width="558"></p>
<p>This is easy enough when you have known light or dark backgrounds; you can create two CSS classes and have users of your CSS library manually add them in depending on context.</p>
<p>Jekyll also offers powerful support for code snippets:</p>
<pre><code class="lang-css"><div class="line"><span class="source css"><span class="meta selector css"><span class="entity name tag custom css"><span>dark-background-contrast</span></span><span>&nbsp;</span></span><span class="meta property-list css"><span class="punctuation section property-list begin css"><span>{</span></span></span></span></div><div class="line"><span class="source css"><span class="meta property-list css"><span>&nbsp;&nbsp;</span><span class="meta property-name css"><span class="support type property-name css"><span>color</span></span></span><span class="meta property-value css"><span class="punctuation separator key-value css"><span>:</span></span><span>&nbsp;</span><span class="support constant color w3c-standard-color-name css"><span>white</span></span><span class="punctuation terminator rule css"><span>;</span></span></span></span></span></div><div class="line"><span class="source css"><span class="meta property-list css"><span class="punctuation section property-list end css"><span>}</span></span></span></span></div><div class="line"><span class="source css"><span>&nbsp;</span></span></div><div class="line"><span class="source css"><span class="meta selector css"><span class="entity name tag custom css"><span>light-background-contrast</span></span><span>&nbsp;</span></span><span class="meta property-list css"><span class="punctuation section property-list begin css"><span>{</span></span></span></span></div><div class="line"><span class="source css"><span class="meta property-list css"><span>&nbsp;&nbsp;</span><span class="meta property-name css"><span class="support type property-name css"><span>color</span></span></span><span class="meta property-value css"><span class="punctuation separator key-value css"><span>:</span></span><span>&nbsp;</span><span class="support constant color w3c-standard-color-name css"><span>black</span></span><span class="punctuation terminator rule css"><span>;</span></span></span></span></span></div><div class="line"><span class="source css"><span class="meta property-list css"><span class="punctuation section property-list end css"><span>}</span></span></span></span></div>
</code></pre>
<p>However, things become a bit trickier if you want to add the concept of a <strong>theme color</strong> to your library, and make it easy to use. This color will very often be used as a background, and will need sufficient contrast for the text that’s placed on top.</p>
<pre><code class="lang-css"><div class="line"><span class="source css"><span class="meta selector css"><span class="entity name tag custom css"><span>theme-color-bg</span></span><span>&nbsp;</span></span><span class="meta property-list css"><span class="punctuation section property-list begin css"><span>{</span></span></span></span></div><div class="line"><span class="source css"><span class="meta property-list css"><span>&nbsp;&nbsp;</span><span class="meta property-name css"><span class="support type property-name css"><span>background-color</span></span></span><span class="meta property-value css"><span class="punctuation separator key-value css"><span>:</span></span><span>&nbsp;</span><span class="constant other color rgb-value css"><span class="punctuation definition constant css"><span>#</span></span><span>3f51b5</span></span><span class="punctuation terminator rule css"><span>;</span></span></span></span></span></div><div class="line"><span class="source css"><span class="meta property-list css"><span class="punctuation section property-list end css"><span>}</span></span></span></span></div><div class="line"><span class="source css"><span>&nbsp;</span></span></div><div class="line"><span class="source css"><span class="meta selector css"><span class="entity name tag custom css"><span>theme-color-bg-contrast</span></span><span>&nbsp;</span></span><span class="meta property-list css"><span class="punctuation section property-list begin css"><span>{</span></span></span></span></div><div class="line"><span class="source css"><span class="meta property-list css"><span>&nbsp;&nbsp;</span><span class="meta property-name css"><span class="support type property-name css"><span>color</span></span></span><span class="meta property-value css"><span class="punctuation separator key-value css"><span>:</span></span><span>&nbsp;</span><span class="support constant color w3c-standard-color-name css"><span>white</span></span><span class="punctuation terminator rule css"><span>;</span></span></span></span></span></div><div class="line"><span class="source css"><span class="meta property-list css"><span class="punctuation section property-list end css"><span>}</span></span></span></span></div>
</code></pre>
<p>In the example above, <code>theme-color-bg-contrast</code> needs to change to a <code>black</code> text color if the user-defined theme color is light. While this is impossible to do in pure CSS (at least until the extremely useful <a href="https://drafts.csswg.org/css-color/">CSS Color Module 4</a> is widely available), it can be done in Sass!</p>
<h2 id="working-out-the-sass">Working out the Sass</h2>
<p>Here’s what the initial Sass should look like:</p>
<pre><code class="lang-scss"><div class="line"><span class="source css scss"><span class="meta set variable"><span class="variable"><span>$theme-color</span></span><span class="punctuation"><span>:</span></span><span>&nbsp;</span><span class="constant other color rgb-value scss"><span class="punctuation definition constant scss"><span>#</span></span><span>3f51b5</span></span><span>&nbsp;</span><span class="keyword other default scss"><span>!default</span></span></span><span>;</span></span></div><div class="line"><span class="source css scss"><span>&nbsp;</span></span></div><div class="line"><span class="source css scss"><span class="entity name tag custom scss"><span>theme-color-bg</span></span><span>&nbsp;</span><span class="meta property-list scss"><span class="punctuation section property-list begin scss"><span>{</span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span>&nbsp;&nbsp;</span><span class="meta property-name scss"><span class="support type property-name scss"><span>background-color</span></span></span><span class="meta property-value scss"><span class="punctuation separator key-value scss"><span>:</span></span><span>&nbsp;</span><span class="variable scss"><span class="variable scss"><span>$theme-color</span></span></span><span class="punctuation terminator rule scss"><span>;</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="punctuation section property-list end scss"><span>}</span></span></span></span></div><div class="line"><span class="source css scss"><span>&nbsp;</span></span></div><div class="line"><span class="source css scss"><span class="entity name tag custom scss"><span>theme-color-bg-contrast</span></span><span>&nbsp;</span><span class="meta property-list scss"><span class="punctuation section property-list begin scss"><span>{</span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span>&nbsp;&nbsp;</span><span class="meta property-name scss"><span class="support type property-name scss"><span>color</span></span></span><span class="meta property-value scss"><span class="punctuation separator key-value scss"><span>:</span></span><span>&nbsp;</span><span class="support function misc scss"><span>choose-contrast-color</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$theme-color</span></span></span><span class="punctuation section function scss"><span>)</span></span><span class="punctuation terminator rule scss"><span>;</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="punctuation section property-list end scss"><span>}</span></span></span></span></div>
</code></pre>
<p>Users can override the <code>$theme-color</code>, and depending on what they pick, the <code>choose-contrast-color</code> function will return either <code>black</code> or <code>white</code>.</p>
<p>So how do we implement <code>choose-contrast-color</code>? It turns out that all of the necessary calculations and minimum contrast rules are well defined in the <a href="https://www.w3.org/TR/WCAG20/">WCAG 2.0 specification</a>. There’s a <a href="https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html">whole section explaining visual contrast in detail</a>, several links to ISO and ANSI standards, and even <a href="https://www.w3.org/Graphics/Color/sRGB.html">papers on the subject</a>. Digging around for a while, I was able to find a <a href="https://www.w3.org/TR/WCAG20-TECHS/G17.html#G17-tests">published W3C technique with a clear description of the algorithm</a>:</p>
<figure>
  <img class="post-image" src="algorithm.png" alt="The algorithm for calculating color contrast" width="1606"/>
  <figcaption>The algorithm for calculating color contrast</figcaption>
</figure>





<p>If you’re familiar with Sass, you’ll quickly notice an issue: the luminance calculations involve exponentiation, which isn’t available in the language or the standard library.</p>
<p>One solution to this would be to use the extensive <a href="http://compass-style.org/">Compass library</a>, which not only includes exponentiation, but also the luminance operations we’re trying to implement. It requires Ruby, however, so it’s not an option for <a href="https://github.com/sass/node-sass">node-sass</a> users. A pure Sass solution would be better.</p>
<h2 id="using-old-tricks">Using old tricks</h2>
<p>I was reviewing my math and exploring the possibility of using Newtonian approximation for the fractional parts of the exponent, until I had a chat with <a href="https://twitter.com/wibblymat">@wibblymat</a>, who happened to be implementing an emulator at the time. He suggested a much simpler, old-school approach: using a lookup table!</p>
<p>The only part that involves exponentiation is the per-channel color space conversions done as part of the luminance calculation. In addition, there are only 256 possible values for each channel. This means that we can easily create a lookup table.</p>
<figure>
  <img class="post-image" src="lookup.png" alt="An excerpt of the lookup table" width="370"/>
  <figcaption>An excerpt of the lookup table</figcaption>
</figure>





<p>You can take a look at <a href="https://github.com/material-components/material-components-web/blob/master/packages/mdc-theme/_constants.scss">the full table</a> that I generated for the <a href="https://github.com/material-components/material-components-web">MDC-Web project</a> to avoid having to generate your own.</p>
<p>With the channel values calculated, we can implement the rest of the algorithm easily:</p>
<pre><code class="lang-scss"><div class="line"><span class="source css scss"><span class="comment block scss"><span class="punctuation whitespace comment trailing scss"><span>/*</span></span><span>*</span></span></span></div><div class="line"><span class="source css scss"><span class="comment block scss"><span>&nbsp;*&nbsp;Calculate&nbsp;the&nbsp;luminance&nbsp;for&nbsp;a&nbsp;color.</span></span></span></div><div class="line"><span class="source css scss"><span class="comment block scss"><span>&nbsp;*&nbsp;See&nbsp;</span><span class="markup underline link https hyperlink"><span>https://www.w3.org/TR/WCAG20-TECHS/G17.html#G17-tests</span></span></span></span></div><div class="line"><span class="source css scss"><span class="comment block scss"><span>&nbsp;</span><span class="punctuation whitespace comment trailing scss"><span>*/</span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta at-rule function scss"><span class="keyword control at-rule function scss"><span class="punctuation definition keyword scss"><span>@</span></span><span>function</span></span><span>&nbsp;</span><span class="support function misc scss"><span>luminance</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$color</span></span></span><span class="punctuation section function scss"><span>)</span></span><span>&nbsp;</span></span><span class="meta property-list scss"><span class="punctuation section property-list begin scss"><span>{</span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="variable scss"><span>&nbsp;&nbsp;</span><span class="variable scss"><span>$red</span></span></span><span class="meta property-value scss"><span class="punctuation separator key-value scss"><span>:</span></span><span>&nbsp;</span><span class="support function misc scss"><span>nth</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$linear-channel-values</span></span></span><span class="punctuation scss"><span>,</span></span><span>&nbsp;</span><span class="support function misc scss"><span>red</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$color</span></span></span><span class="punctuation section function scss"><span>)</span></span><span>&nbsp;</span><span class="constant numeric scss"><span>+&nbsp;1</span></span><span class="punctuation section function scss"><span>)</span></span><span class="punctuation terminator rule scss"><span>;</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="variable scss"><span>&nbsp;&nbsp;</span><span class="variable scss"><span>$green</span></span></span><span class="meta property-value scss"><span class="punctuation separator key-value scss"><span>:</span></span><span>&nbsp;</span><span class="support function misc scss"><span>nth</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$linear-channel-values</span></span></span><span class="punctuation scss"><span>,</span></span><span>&nbsp;</span><span class="support function misc scss"><span>green</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$color</span></span></span><span class="punctuation section function scss"><span>)</span></span><span>&nbsp;</span><span class="constant numeric scss"><span>+&nbsp;1</span></span><span class="punctuation section function scss"><span>)</span></span><span class="punctuation terminator rule scss"><span>;</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="variable scss"><span>&nbsp;&nbsp;</span><span class="variable scss"><span>$blue</span></span></span><span class="meta property-value scss"><span class="punctuation separator key-value scss"><span>:</span></span><span>&nbsp;</span><span class="support function misc scss"><span>nth</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$linear-channel-values</span></span></span><span class="punctuation scss"><span>,</span></span><span>&nbsp;</span><span class="support function misc scss"><span>blue</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$color</span></span></span><span class="punctuation section function scss"><span>)</span></span><span>&nbsp;</span><span class="constant numeric scss"><span>+&nbsp;1</span></span><span class="punctuation section function scss"><span>)</span></span><span class="punctuation terminator rule scss"><span>;</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span>&nbsp;</span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="meta at-rule return scss"><span>&nbsp;&nbsp;</span><span class="keyword control return scss"><span class="punctuation definition keyword scss"><span>@</span></span><span>return</span></span><span class="constant numeric scss"><span>&nbsp;.2126</span></span><span>&nbsp;*</span><span class="variable scss"><span>&nbsp;</span><span class="variable scss"><span>$red</span></span><span>&nbsp;</span></span><span class="constant numeric scss"><span>+&nbsp;.7152</span></span><span>&nbsp;*</span><span class="variable scss"><span>&nbsp;</span><span class="variable scss"><span>$green</span></span><span>&nbsp;</span></span><span class="constant numeric scss"><span>+&nbsp;.0722</span></span><span>&nbsp;*</span><span class="variable scss"><span>&nbsp;</span><span class="variable scss"><span>$blue</span></span></span></span><span>;</span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="punctuation section property-list end scss"><span>}</span></span></span></span></div><div class="line"><span class="source css scss"><span>&nbsp;</span></span></div><div class="line"><span class="source css scss"><span class="comment block scss"><span class="punctuation whitespace comment trailing scss"><span>/*</span></span><span>*</span></span></span></div><div class="line"><span class="source css scss"><span class="comment block scss"><span>&nbsp;*&nbsp;Calculate&nbsp;the&nbsp;contrast&nbsp;ratio&nbsp;between&nbsp;two&nbsp;colors.</span></span></span></div><div class="line"><span class="source css scss"><span class="comment block scss"><span>&nbsp;*&nbsp;See&nbsp;</span><span class="markup underline link https hyperlink"><span>https://www.w3.org/TR/WCAG20-TECHS/G17.html#G17-tests</span></span></span></span></div><div class="line"><span class="source css scss"><span class="comment block scss"><span>&nbsp;</span><span class="punctuation whitespace comment trailing scss"><span>*/</span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta at-rule function scss"><span class="keyword control at-rule function scss"><span class="punctuation definition keyword scss"><span>@</span></span><span>function</span></span><span>&nbsp;</span><span class="support function misc scss"><span>contrast</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$back</span></span></span><span class="punctuation scss"><span>,</span></span><span class="variable scss"><span>&nbsp;</span><span class="variable scss"><span>$front</span></span></span><span class="punctuation section function scss"><span>)</span></span><span>&nbsp;</span></span><span class="meta property-list scss"><span class="punctuation section property-list begin scss"><span>{</span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="variable scss"><span>&nbsp;&nbsp;</span><span class="variable scss"><span>$backLum</span></span></span><span class="meta property-value scss"><span class="punctuation separator key-value scss"><span>:</span></span><span>&nbsp;</span><span class="support function misc scss"><span>luminance</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$back</span></span></span><span class="punctuation section function scss"><span>)</span></span><span>&nbsp;</span><span class="constant numeric scss"><span>+&nbsp;.05</span></span><span class="punctuation terminator rule scss"><span>;</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="variable scss"><span>&nbsp;&nbsp;</span><span class="variable scss"><span>$foreLum</span></span></span><span class="meta property-value scss"><span class="punctuation separator key-value scss"><span>:</span></span><span>&nbsp;</span><span class="support function misc scss"><span>luminance</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$front</span></span></span><span class="punctuation section function scss"><span>)</span></span><span>&nbsp;</span><span class="constant numeric scss"><span>+&nbsp;.05</span></span><span class="punctuation terminator rule scss"><span>;</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span>&nbsp;</span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="meta at-rule return scss"><span>&nbsp;&nbsp;</span><span class="keyword control return scss"><span class="punctuation definition keyword scss"><span>@</span></span><span>return</span></span><span>&nbsp;</span><span class="support function misc scss"><span>max</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$backLum</span></span></span><span class="punctuation scss"><span>,</span></span><span class="variable scss"><span>&nbsp;</span><span class="variable scss"><span>$foreLum</span></span></span><span class="punctuation section function scss"><span>)</span></span><span>&nbsp;/&nbsp;</span><span class="support function misc scss"><span>min</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$backLum</span></span></span><span class="punctuation scss"><span>,</span></span><span class="variable scss"><span>&nbsp;</span><span class="variable scss"><span>$foreLum</span></span></span><span class="punctuation section function scss"><span>)</span></span></span><span>;</span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="punctuation section property-list end scss"><span>}</span></span></span></span></div><div class="line"><span class="source css scss"><span>&nbsp;</span></span></div><div class="line"><span class="source css scss"><span class="comment block scss"><span class="punctuation whitespace comment trailing scss"><span>/*</span></span><span>*</span></span></span></div><div class="line"><span class="source css scss"><span class="comment block scss"><span>&nbsp;*&nbsp;Determine&nbsp;whether&nbsp;to&nbsp;use&nbsp;dark&nbsp;or&nbsp;light&nbsp;text&nbsp;on&nbsp;top&nbsp;of&nbsp;given&nbsp;color.</span></span></span></div><div class="line"><span class="source css scss"><span class="comment block scss"><span>&nbsp;*&nbsp;Returns&nbsp;black&nbsp;for&nbsp;dark&nbsp;text&nbsp;and&nbsp;white&nbsp;for&nbsp;light&nbsp;text.</span></span></span></div><div class="line"><span class="source css scss"><span class="comment block scss"><span>&nbsp;</span><span class="punctuation whitespace comment trailing scss"><span>*/</span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta at-rule function scss"><span class="keyword control at-rule function scss"><span class="punctuation definition keyword scss"><span>@</span></span><span>function</span></span><span>&nbsp;</span><span class="support function misc scss"><span>choose-contrast-color</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$color</span></span></span><span class="punctuation section function scss"><span>)</span></span><span>&nbsp;</span></span><span class="meta property-list scss"><span class="punctuation section property-list begin scss"><span>{</span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="variable scss"><span>&nbsp;&nbsp;</span><span class="variable scss"><span>$lightContrast</span></span></span><span class="meta property-value scss"><span class="punctuation separator key-value scss"><span>:</span></span><span>&nbsp;</span><span class="support function misc scss"><span>contrast</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$color</span></span></span><span class="punctuation scss"><span>,</span></span><span>&nbsp;</span><span class="support constant color w3c-standard-color-name scss"><span>white</span></span><span class="punctuation section function scss"><span>)</span></span><span class="punctuation terminator rule scss"><span>;</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="variable scss"><span>&nbsp;&nbsp;</span><span class="variable scss"><span>$darkContrast</span></span></span><span class="meta property-value scss"><span class="punctuation separator key-value scss"><span>:</span></span><span>&nbsp;</span><span class="support function misc scss"><span>contrast</span></span><span class="punctuation section function scss"><span>(</span></span><span class="variable scss"><span class="variable scss"><span>$color</span></span></span><span class="punctuation scss"><span>,</span></span><span>&nbsp;</span><span class="support constant color w3c-standard-color-name scss"><span>black</span></span><span class="punctuation section function scss"><span>)</span></span><span class="punctuation terminator rule scss"><span>;</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span>&nbsp;</span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="meta at-rule if scss"><span>&nbsp;&nbsp;</span><span class="keyword control if scss"><span class="punctuation definition keyword scss"><span>@</span></span><span>if</span></span><span>&nbsp;</span><span>(</span><span class="variable scss"><span class="variable scss"><span>$lightContrast</span></span><span>&nbsp;</span></span><span>&gt;</span><span class="variable scss"><span>&nbsp;</span><span class="variable scss"><span>$darkContrast</span></span></span><span>)</span><span>&nbsp;</span></span><span class="meta property-list scss"><span class="punctuation section property-list begin scss"><span>{</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="meta property-list scss"><span class="meta at-rule return scss"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control return scss"><span class="punctuation definition keyword scss"><span>@</span></span><span>return</span></span><span>&nbsp;</span><span class="support constant color w3c-standard-color-name scss"><span>white</span></span></span><span>;</span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="meta property-list scss"><span>&nbsp;&nbsp;</span><span class="punctuation section property-list end scss"><span>}</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="meta at-rule else scss"><span>&nbsp;&nbsp;</span><span class="keyword control else scss"><span class="punctuation definition keyword scss"><span>@</span></span><span>else&nbsp;</span></span></span><span class="meta property-list scss"><span class="punctuation section property-list begin scss"><span>{</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="meta property-list scss"><span class="meta at-rule return scss"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control return scss"><span class="punctuation definition keyword scss"><span>@</span></span><span>return</span></span><span>&nbsp;</span><span class="support constant color w3c-standard-color-name scss"><span>black</span></span></span><span>;</span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="meta property-list scss"><span>&nbsp;&nbsp;</span><span class="punctuation section property-list end scss"><span>}</span></span></span></span></span></div><div class="line"><span class="source css scss"><span class="meta property-list scss"><span class="punctuation section property-list end scss"><span>}</span></span></span></span></div>
</code></pre>
<p>That’s it! We now have contrast calculation in Sass, and we’re automatically picking black or white text, depending on which provides the most contrast. This can have a huge impact on readability, particularly for users with low vision.</p>
<p>This solution only requires an extra, pre-calculated constants file that will never change. It works with any Sass implementation, and it won’t bloat your CSS since it’s only used at build time. Pretty neat!</p>
<p>Next time, I want to look at how to do the same thing in JavaScript, at runtime, so you can have dynamic theming with CSS custom properties. See you then!</p>
<p><strong>Edit</strong>: <a href="http://www.sassmeister.com/gist/ccc72f71137fe29039c92c0a9fe9b657">here’s a Sassmeister live demo</a> of the technique above.</p>


  </div>

  Tags:&nbsp;
  <div class="post-tags">
    
      sass
    
      theming
    
  </div>
</article>

    </main>

    <footer class="footer">
  <div class="footer-contents">
    <img class="footer-avatar" src="/assets/images/avatar.jpg" alt="Author's avatar">

    <div class="footer-text">
      <h2 class="footer-heading">Hey there!</h2>
      <p class="footer-description">I’m Sérgio, and I work at Web Developer Relations at Google, helping developers make the web a better place.</p>
    </div>

    <div class="footer-icons">
      <div class="footer-icons-row">
        <a href="https://twitter.com/sergiomdgomes" class="footer-bubble footer-twitter"></a>
        <a href="mailto:mail@sgom.es" class="footer-bubble footer-email"></a>
      </div>
      <div class="footer-icons-row">
        <a href="/feed.xml" class="footer-bubble footer-feed"></a>
        <a href="https://github.com/sgomes" class="footer-bubble footer-github"></a>
      </div>
    </div>
  </div>
  <div class="footer-bottom">
    <div class="footer-copyright">Articles under
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons 4.0 Attribution</a>,
    code under <a rel="license" href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a>
    (unless otherwise indicated).</div>
  </div>
</footer>


    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js').catch(function(err) {
          console.log('Service worker registration failed: ', err);
        });
      }
    </script>

  </body>

</html>
